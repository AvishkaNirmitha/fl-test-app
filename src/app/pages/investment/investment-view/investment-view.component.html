<div class="row">
  <div class="col-lg-12">
    <div class="row pb-4">
      <div class="row col-12 d-flex m-0">
        <div class="col-md-6 col-12 m-t-15 ml-0">
          <mat-card
            class="cardWithShadow mb-0 h-100"
            [ngClass]="{
            'opacity-5 cursor-not-allowed': this.userDetails?.is_affiliate_user,
          }"
          >
            <mat-card-content class="">
              <mat-card-title
                class="font-weight-bold mat-mdc-card-title mb-2 text-center"
                >{{ firstPackage["name"] }}</mat-card-title
              >
              <div class="row mt-1">
                <div class="align-items-center col-3 d-flex text-right">
                  <img
                    class="package-img"
                    alt=""
                    src="../../../../assets/images/award.png"
                  />
                </div>

                <div class="col-9">
                  <div class="">
                    <div class="d-flex align-items-center">
                      <p class="col-4 font-0-9 m-0 pl-0">Minimum deposit</p>
                      <div class="col-9">No Deposit</div>
                    </div>
                  </div>
                  <div class="">
                    <div class="align-items-center d-flex mt-2">
                      <p class="col-4 font-0-9 m-0 pl-0">Admin charges</p>
                      <div class="col-9 font-1 font-weight-500 text-center">
                        {{
                          firstPackage["min_xtr_balance"]
                            | currency : "TEX " : "symbol" : "1.2-2"
                        }}
                      </div>
                    </div>
                  </div>
                  <div class="">
                    <div class="align-items-center d-flex mt-2">
                      <p class="col-4 font-0-9 m-0 pl-0">Total</p>
                      <div class="col-9 font-1 font-weight-500 text-center">
                        {{
                          firstPackage["min_xtr_balance"]
                            | currency : "TEX " : "symbol" : "1.2-2"
                        }}
                      </div>
                    </div>
                  </div>
                </div>

                <div
                  class="col-12 mt-4"
                  [ngClass]="{
                  'mt-5': this.userDetails?.is_affiliate_user,
                }"
                >
                  <div class="text-center">
                    <button
                      type="submit"
                      mat-flat-button
                      color="primary"
                      class="pl-4 pr-4 font-weight-bold"
                      data-toggle="tooltip"
                      data-placement="top"
                      title="go to profile page and enable two factor auth"
                      (click)="handleRefPackageClick()"
                      *ngIf="!this.userDetails?.is_affiliate_user"
                    >
                      &nbsp; &nbsp; Purchase &nbsp; &nbsp;
                    </button>

                    <span *ngIf="this.userDetails?.is_affiliate_user" class="">
                      you have already purchased this Referral License
                    </span>
                  </div>
                </div>
              </div>
            </mat-card-content>
          </mat-card>
        </div>

        <div
          class="col-md-6 col-12 m-t-15 ml-0"
          *ngFor="let item of dataList; index as index"
        >
          <form [formGroup]="rForm">
            <mat-card class="cardWithShadow mb-0">
              <mat-card-content class="">
                <mat-card-title
                  class="font-weight-bold mat-mdc-card-title mb-2 text-center capitalize-first-letter"
                >
                  {{ item?.name }}
                </mat-card-title>
                <div class="row mt-1">
                  <div class="align-items-center col-3 d-flex text-right">
                    <img
                      class="package-img"
                      alt=""
                      [src]="getImagePath(item.image)"
                    />
                  </div>

                  <div class="col-9">
                    <div class="">
                      <div class="d-flex align-items-center">
                        <p class="col-4 font-0-9 m-0 pl-0">
                          Minimum deposit
                          {{
                            item?.min_xtr_balance
                              | currency : " " : "symbol" : "1.0-0"
                          }}
                          ( TEX) or
                        </p>
                        <div class="col-9">
                          <mat-form-field
                            appearance="outline"
                            class="only-input w-100"
                            color="primary"
                            subscriptSizing="dynamic"
                          >
                            <input
                              matInput
                              placeholder="Enter Amount"
                              type="number"
                              class="input-only"
                              [formControlName]="'package' + index"
                            />

                            <mat-error *ngIf="validateFormRequiredState(index)">
                              Minimum deposit is required
                            </mat-error>
                            <mat-error *ngIf="validateMinMaxValue(index)">
                              Minimum deposit should be
                              {{
                                item?.min_xtr_balance
                                  | currency : "TEX " : "symbol" : "1.2-2"
                              }}
                              to
                              {{
                                item?.max_xtr_balance
                                  | currency : "TEX " : "symbol" : "1.2-2"
                              }}
                            </mat-error>
                          </mat-form-field>
                        </div>
                      </div>
                    </div>
                    <div class="">
                      <div class="align-items-center d-flex mt-2">
                        <p class="col-4 font-0-9 m-0 pl-0">
                          Admin charges ({{
                            item?.service_fee_percentage | number : "1.2-2"
                          }}%)
                        </p>
                        <div class="col-9 font-1 font-weight-500 text-center">
                          <ng-container
                            *ngIf="!rForm.get('package' + index)?.value"
                          >
                            {{ 0 | currency : "TEX " : "symbol" : "1.2-2" }}
                          </ng-container>
                          <ng-container
                            *ngIf="rForm.get('package' + index)?.value"
                          >
                            {{
                              generateAdminCharge(
                                rForm.get("package" + index)?.value,
                                item?.service_fee_percentage
                              ) | currency : "TEX " : "symbol" : "1.2-2"
                            }}
                          </ng-container>
                        </div>
                      </div>
                    </div>
                    <div class="">
                      <div class="align-items-center d-flex mt-2">
                        <p class="col-4 font-0-9 m-0 pl-0">Total</p>
                        <div class="col-9 font-1 font-weight-500 text-center">
                          <ng-container
                            *ngIf="!rForm.get('package' + index)?.value"
                          >
                            {{ 0 | currency : "TEX " : "symbol" : "1.2-2" }}
                          </ng-container>
                          <ng-container
                            *ngIf="rForm.get('package' + index)?.value"
                          >
                            {{
                              getTotalValue(index)
                                | currency : "TEX " : "symbol" : "1.2-2"
                            }}
                          </ng-container>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="col-12 mt-3">
                    <div class="text-center">
                      <button
                        type="submit"
                        mat-flat-button
                        color="primary"
                        class="pl-4 pr-4 font-weight-bold"
                        data-toggle="tooltip"
                        data-placement="top"
                        title="go to profile page and enable two factor auth"
                        [disabled]="!rForm.get('package' + index)?.valid"
                        (click)="handleInvestClick(index, item)"
                      >
                        &nbsp; &nbsp; Invest Now &nbsp; &nbsp;
                      </button>
                    </div>

                    <div
                      class="cursor-pointer font-weight-bold get-code-btn mt-3 text-center text-primary"
                      (click)="openOtherPackageDetailsModel(item)"
                    >
                      More Details
                    </div>
                  </div>
                </div>
              </mat-card-content>
            </mat-card>
          </form>
        </div>
      </div>
    </div>
  </div>
  <app-loader *ngIf="loading"></app-loader>
</div>
